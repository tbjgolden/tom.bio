---
import Layout from "src/components/layout.astro";
import Header from "src/components/header.astro";
import EditableMd from "src/components/editable-md.astro";
import EditableText from "src/components/editable-text.astro";

export const getStaticPaths = async () => {
  const articles = [
    {
      slug: "example",
      flex: "example flex",
      title: "Example",
      markdown: `## a\n\n## b\n`,
    },
  ];
  return articles.map((article) => {
    const slug = article.slug;
    return {
      params: { slug },
      props: {
        article,
      },
    };
  });
};

const { article } = Astro.props;
---

<Layout pageTitle={`${article.title} Â· tom`}>
  <Header actualPath={`posts/${article.slug}/edit`} />

  <EditableText name={article.slug} type="posts" key="title" />
  <EditableText name={article.slug} type="posts" key="imageUrl" />
  <EditableMd name={article.slug} type="posts" />
</Layout>
<script>
  document
    .querySelectorAll(
      "#article>h1,#article>h2,#article>h3,#article>h4,#article>h5,#article>h6"
    )
    .forEach(function (el) {
      const newNode = document.createElement("a");
      newNode.setAttribute("href", "#" + el.getAttribute("id"));
      newNode.innerText = "#";
      el.insertBefore(newNode, el.firstChild);
    });
</script>
<style>
  article :global(h1, h2, h3, h4, h5, h6) {
    position: relative;
  }
  article
    :global(h1 > a:first-child, h2 > a:first-child, h3 > a:first-child, h4
      > a:first-child, h5 > a:first-child, h6 > a:first-child) {
    display: none;
  }
  article
    :global(h1:hover > a:first-child, h2:hover > a:first-child, h3:hover
      > a:first-child, h4:hover > a:first-child, h5:hover
      > a:first-child, h6:hover > a:first-child) {
    width: calc(100% + 1em);
    height: 1em;
    top: 0;
    right: 0;
    display: inline-block;
    position: absolute;
  }
</style>
